var $ = require('jquery');
var Backbone = require('backbone');

Backbone.$ = $;

var ProjectViewClass            = require('project/ProjectView');
var projectView;

// var ProjectsListItemClass            = require('./projectsListItem/ProjectsListItem');
// //var ProjectsListItem;

var ProjectsListCollectionClass = require('projectsList/ProjectsListCollection');
var projectsListCollection = new ProjectsListCollectionClass();

var ProjectsListViewClass = require('projectsList/ProjectsListView');

var HoverViewClass = require('HoverView');

var PaginationViewClass = require('pagination/PaginationView');


module.exports = Backbone.Router.extend({
  initialize: function(){
    var projectsListView = new ProjectsListViewClass({ el: $('#portfolio #projects-list') });
    var hoverView = new HoverViewClass();
    var paginationViewClass = new PaginationViewClass({el: $('#portfolio #pagination')});
  },

  routes: {
    "":                 "projects",

    ":id":        "project",
    "project/:id":        "project"
  },

  projects: function(){
    projectsListCollection.fetch({
      success: function (datas) {
        var randomProjectIndex = Math.floor((Math.random() * datas.length));
        projectView = new ProjectViewClass({ el: $('#portfolio figure'), model: datas.get(randomProjectIndex) });
        $('#portfolio #projects-list li').eq(randomProjectIndex).find('a').addClass('seen');
      }
    });
  },

  project: function(id) {

    projectsListCollection.fetch({
      success: function (datas) {
        projectView = new ProjectViewClass({ el: $('#portfolio figure'), model: datas.get(id) });
        $('#portfolio #projects-list li').eq(id).find('a').addClass('seen');
      }
    });
  }
});